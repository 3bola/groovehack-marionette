Groovehack.module("Entities", function(Entities, Groovehack, Backbone, Marionette, $, _) {
  var StorageMixin, findStorageKey;
  findStorageKey = function(entity) {
    if (entity.urlRoot) {
      return _.result(entity, "urlRoot");
    }
    if (entity.url) {
      return _.result(entity, "url");
    }
    if (entity.collection && entity.collection.url) {
      return _.result(entity.collection, "url");
    }
    throw new Error("Unable to determine storage key");
  };
  StorageMixin = function(entityPrototype) {
    var storageKey;
    storageKey = findStorageKey(entityPrototype);
    return {
      localStorage: new Backbone.LocalStorage(storageKey)
    };
  };
  return Entities.configureStorage = function(entity) {
    return _.extend(entity.prototype, new StorageMixin(entity.prototype));
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcHMvY29uZmlnL3N0b3JhZ2UvbG9jYWxzdG9yYWdlLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxVQUFVLENBQUMsTUFBWCxDQUFrQixVQUFsQixFQUE4QixTQUFDLFFBQUQsRUFBVyxVQUFYLEVBQXVCLFFBQXZCLEVBQWlDLFVBQWpDLEVBQTZDLENBQTdDLEVBQWdELENBQWhELEdBQUE7QUFFN0IsTUFBQSw0QkFBQTtBQUFBLEVBQUEsY0FBQSxHQUFpQixTQUFDLE1BQUQsR0FBQTtBQUNoQixJQUFBLElBQXFDLE1BQU0sQ0FBQyxPQUE1QztBQUFBLGFBQU8sQ0FBQyxDQUFDLE1BQUYsQ0FBUyxNQUFULEVBQWlCLFNBQWpCLENBQVAsQ0FBQTtLQUFBO0FBQ0EsSUFBQSxJQUFpQyxNQUFNLENBQUMsR0FBeEM7QUFBQSxhQUFPLENBQUMsQ0FBQyxNQUFGLENBQVMsTUFBVCxFQUFpQixLQUFqQixDQUFQLENBQUE7S0FEQTtBQUVBLElBQUEsSUFBNEMsTUFBTSxDQUFDLFVBQVAsSUFBcUIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFuRjtBQUFBLGFBQU8sQ0FBQyxDQUFDLE1BQUYsQ0FBUyxNQUFNLENBQUMsVUFBaEIsRUFBNEIsS0FBNUIsQ0FBUCxDQUFBO0tBRkE7QUFHQSxVQUFVLElBQUEsS0FBQSxDQUFNLGlDQUFOLENBQVYsQ0FKZ0I7RUFBQSxDQUFqQixDQUFBO0FBQUEsRUFNQSxZQUFBLEdBQWUsU0FBQyxlQUFELEdBQUE7QUFDZCxRQUFBLFVBQUE7QUFBQSxJQUFBLFVBQUEsR0FBYSxjQUFBLENBQWUsZUFBZixDQUFiLENBQUE7V0FDQTtBQUFBLE1BQUEsWUFBQSxFQUFrQixJQUFBLFFBQVEsQ0FBQyxZQUFULENBQXNCLFVBQXRCLENBQWxCO01BRmM7RUFBQSxDQU5mLENBQUE7U0FVQSxRQUFRLENBQUMsZ0JBQVQsR0FBNEIsU0FBQyxNQUFELEdBQUE7V0FDM0IsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxNQUFNLENBQUMsU0FBaEIsRUFBK0IsSUFBQSxZQUFBLENBQWEsTUFBTSxDQUFDLFNBQXBCLENBQS9CLEVBRDJCO0VBQUEsRUFaQztBQUFBLENBQTlCLENBQUEsQ0FBQSIsImZpbGUiOiJhcHBzL2NvbmZpZy9zdG9yYWdlL2xvY2Fsc3RvcmFnZS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIkdyb292ZWhhY2subW9kdWxlIFwiRW50aXRpZXNcIiwgKEVudGl0aWVzLCBHcm9vdmVoYWNrLCBCYWNrYm9uZSwgTWFyaW9uZXR0ZSwgJCwgXykgLT5cblx0XG5cdGZpbmRTdG9yYWdlS2V5ID0gKGVudGl0eSkgLT5cblx0XHRyZXR1cm4gXy5yZXN1bHQgZW50aXR5LCBcInVybFJvb3RcIiBpZiBlbnRpdHkudXJsUm9vdFxuXHRcdHJldHVybiBfLnJlc3VsdCBlbnRpdHksIFwidXJsXCIgaWYgZW50aXR5LnVybFxuXHRcdHJldHVybiBfLnJlc3VsdCBlbnRpdHkuY29sbGVjdGlvbiwgXCJ1cmxcIiBpZiBlbnRpdHkuY29sbGVjdGlvbiAmJiBlbnRpdHkuY29sbGVjdGlvbi51cmxcblx0XHR0aHJvdyBuZXcgRXJyb3IgXCJVbmFibGUgdG8gZGV0ZXJtaW5lIHN0b3JhZ2Uga2V5XCJcblxuXHRTdG9yYWdlTWl4aW4gPSAoZW50aXR5UHJvdG90eXBlKSAtPlxuXHRcdHN0b3JhZ2VLZXkgPSBmaW5kU3RvcmFnZUtleSBlbnRpdHlQcm90b3R5cGVcblx0XHRsb2NhbFN0b3JhZ2U6IG5ldyBCYWNrYm9uZS5Mb2NhbFN0b3JhZ2Ugc3RvcmFnZUtleVxuXG5cdEVudGl0aWVzLmNvbmZpZ3VyZVN0b3JhZ2UgPSAoZW50aXR5KSAtPlxuXHRcdF8uZXh0ZW5kIGVudGl0eS5wcm90b3R5cGUsIG5ldyBTdG9yYWdlTWl4aW4gZW50aXR5LnByb3RvdHlwZSJdfQ==